<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="de">
<head>
<!-- Generated by javadoc (11.0.2) on Fri May 03 08:31:16 CEST 2019 -->
<title>CSRFPreventionUtil</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2019-05-03">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="CSRFPreventionUtil";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":9,"i1":9,"i2":9,"i3":9,"i4":9,"i5":9,"i6":9,"i7":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CSRFPreventionUtil.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">de.db.derpate.util</a></div>
<h2 title="Class CSRFPreventionUtil" class="title">Class CSRFPreventionUtil</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>de.db.derpate.util.CSRFPreventionUtil</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<pre>public final class <span class="typeNameLabel">CSRFPreventionUtil</span>
extends java.lang.Object</pre>
<div class="block">This util should be used to prevent cross-site request forgery. It creates
 random tokens, which can be used in hidden fields in a form. The backend then
 checks if the token is valid. That way it is safe to say, that the user
 filled out the form and did not just used the backend interface.</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>MichelBlank</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#FIELD_NAME">FIELD_NAME</a></span></code></th>
<td class="colLast">
<div class="block">frontend html field name for use in an hidden input field</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#HEADER_FIELD">HEADER_FIELD</a></span></code></th>
<td class="colLast">
<div class="block">Header that can be used alternatively (or is sent by server, if old one got
 invalidated)</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#SC_INVALID_TOKEN">SC_INVALID_TOKEN</a></span></code></th>
<td class="colLast">
<div class="block">Http Status Code sent, when token was invalid</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#SESSION_ATTRIBUTE_PREFIX">SESSION_ATTRIBUTE_PREFIX</a></span></code></th>
<td class="colLast">
<div class="block">key, which is used to store the <code>Map</code> in <code>HttpSession</code>'s
 attributes</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#TOKEN_LENGTH">TOKEN_LENGTH</a></span></code></th>
<td class="colLast">
<div class="block">Token length in bytes</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colSecond" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private </code></td>
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">CSRFPreventionUtil</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#attachNewTokenToHttpResponse(javax.servlet.http.HttpSession,javax.servlet.http.HttpServletResponse,de.db.derpate.CSRFForm)">attachNewTokenToHttpResponse</a></span>&#8203;(@NonNull javax.servlet.http.HttpSession&nbsp;session,
                            @NonNull javax.servlet.http.HttpServletResponse&nbsp;response,
                            @NonNull <a href="../CSRFForm.html" title="enum in de.db.derpate">CSRFForm</a>&nbsp;form)</code></th>
<td class="colLast">
<div class="block">Attaches a http header to the <code>HttpServletResponse</code>, that includes a
 new valid csrf token<br>
 <b>Should be used, when a valid token was sent beforehand!</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#checkToken(javax.servlet.http.HttpSession,de.db.derpate.CSRFForm,java.lang.String)">checkToken</a></span>&#8203;(@NonNull javax.servlet.http.HttpSession&nbsp;session,
          @NonNull <a href="../CSRFForm.html" title="enum in de.db.derpate">CSRFForm</a>&nbsp;form,
          @NonNull java.lang.String&nbsp;token)</code></th>
<td class="colLast">
<div class="block">This method checks if the given token was registered in the user's
 <code>HttpSession</code></div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>private static @NonNull java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#generateRandomString(int)">generateRandomString</a></span>&#8203;(int&nbsp;length)</code></th>
<td class="colLast">
<div class="block">Generates a random <code>Base64</code> <code>String</code></div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>static @NonNull java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#generateToken(javax.servlet.http.HttpSession,de.db.derpate.CSRFForm)">generateToken</a></span>&#8203;(@Nullable javax.servlet.http.HttpSession&nbsp;session,
             @NonNull <a href="../CSRFForm.html" title="enum in de.db.derpate">CSRFForm</a>&nbsp;form)</code></th>
<td class="colLast">
<div class="block">This method generates a token and registers it in the user's
 <code>HttpSession</code>.<br>
 The session should not be null, as the token cannot be persisted without</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#generateTokenForGETParameter(javax.servlet.http.HttpSession,de.db.derpate.CSRFForm)">generateTokenForGETParameter</a></span>&#8203;(@Nullable javax.servlet.http.HttpSession&nbsp;session,
                            @NonNull <a href="../CSRFForm.html" title="enum in de.db.derpate">CSRFForm</a>&nbsp;form)</code></th>
<td class="colLast">
<div class="block">Automatically escapes characters for use as a uri paramter.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>private static @Nullable java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getFormTokenFromSession(javax.servlet.http.HttpSession,de.db.derpate.CSRFForm)">getFormTokenFromSession</a></span>&#8203;(@NonNull javax.servlet.http.HttpSession&nbsp;session,
                       @NonNull <a href="../CSRFForm.html" title="enum in de.db.derpate">CSRFForm</a>&nbsp;form)</code></th>
<td class="colLast">
<div class="block">Returns the CSRF-Token for a given form and session</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>private static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getSessionAttributeName(de.db.derpate.CSRFForm)">getSessionAttributeName</a></span>&#8203;(@NonNull <a href="../CSRFForm.html" title="enum in de.db.derpate">CSRFForm</a>&nbsp;form)</code></th>
<td class="colLast">
<div class="block">Returns the name of the session attribute (prefix
 (<a href="#SESSION_ATTRIBUTE_PREFIX">"csrfTokenList_"</a>) + <a href="../CSRFForm.html#toString()"><code>CSRFForm.toString()</code></a>).</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>private static void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#saveToSession(javax.servlet.http.HttpSession,de.db.derpate.CSRFForm,java.lang.String)">saveToSession</a></span>&#8203;(@NonNull javax.servlet.http.HttpSession&nbsp;session,
             @NonNull <a href="../CSRFForm.html" title="enum in de.db.derpate">CSRFForm</a>&nbsp;form,
             @NonNull java.lang.String&nbsp;token)</code></th>
<td class="colLast">
<div class="block">Sets the session attributes based on the given form</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="FIELD_NAME">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>FIELD_NAME</h4>
<pre>public static final&nbsp;java.lang.String FIELD_NAME</pre>
<div class="block">frontend html field name for use in an hidden input field</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#de.db.derpate.util.CSRFPreventionUtil.FIELD_NAME">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="TOKEN_LENGTH">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TOKEN_LENGTH</h4>
<pre>public static final&nbsp;int TOKEN_LENGTH</pre>
<div class="block">Token length in bytes</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#de.db.derpate.util.CSRFPreventionUtil.TOKEN_LENGTH">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="HEADER_FIELD">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>HEADER_FIELD</h4>
<pre>public static final&nbsp;java.lang.String HEADER_FIELD</pre>
<div class="block">Header that can be used alternatively (or is sent by server, if old one got
 invalidated)</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#de.db.derpate.util.CSRFPreventionUtil.HEADER_FIELD">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="SC_INVALID_TOKEN">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SC_INVALID_TOKEN</h4>
<pre>public static final&nbsp;int SC_INVALID_TOKEN</pre>
<div class="block">Http Status Code sent, when token was invalid</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#de.db.derpate.util.CSRFPreventionUtil.SC_INVALID_TOKEN">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="SESSION_ATTRIBUTE_PREFIX">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>SESSION_ATTRIBUTE_PREFIX</h4>
<pre>public static final&nbsp;java.lang.String SESSION_ATTRIBUTE_PREFIX</pre>
<div class="block">key, which is used to store the <code>Map</code> in <code>HttpSession</code>'s
 attributes</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#de.db.derpate.util.CSRFPreventionUtil.SESSION_ATTRIBUTE_PREFIX">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>CSRFPreventionUtil</h4>
<pre>private&nbsp;CSRFPreventionUtil()</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="generateToken(javax.servlet.http.HttpSession,de.db.derpate.CSRFForm)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateToken</h4>
<pre class="methodSignature">public static&nbsp;@NonNull java.lang.String&nbsp;generateToken&#8203;(@Nullable javax.servlet.http.HttpSession&nbsp;session,
                                                      @NonNull <a href="../CSRFForm.html" title="enum in de.db.derpate">CSRFForm</a>&nbsp;form)</pre>
<div class="block">This method generates a token and registers it in the user's
 <code>HttpSession</code>.<br>
 The session should not be null, as the token cannot be persisted without</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>session</code> - client's <code>HttpSession</code></dd>
<dd><code>form</code> - <a href="../CSRFForm.html" title="enum in de.db.derpate"><code>CSRFForm</code></a> used to limit token to this specific form</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>random string</dd>
</dl>
</li>
</ul>
<a id="generateTokenForGETParameter(javax.servlet.http.HttpSession,de.db.derpate.CSRFForm)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateTokenForGETParameter</h4>
<pre class="methodSignature">public static&nbsp;java.lang.String&nbsp;generateTokenForGETParameter&#8203;(@Nullable javax.servlet.http.HttpSession&nbsp;session,
                                                            @NonNull <a href="../CSRFForm.html" title="enum in de.db.derpate">CSRFForm</a>&nbsp;form)</pre>
<div class="block">Automatically escapes characters for use as a uri paramter.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>session</code> - client's <code>HttpSession</code></dd>
<dd><code>form</code> - <a href="../CSRFForm.html" title="enum in de.db.derpate"><code>CSRFForm</code></a> used to limit token to this specific form</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>random string</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#generateToken(javax.servlet.http.HttpSession,de.db.derpate.CSRFForm)"><code>generateToken(HttpSession, CSRFForm)</code></a></dd>
</dl>
</li>
</ul>
<a id="generateRandomString(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateRandomString</h4>
<pre class="methodSignature">private static&nbsp;@NonNull java.lang.String&nbsp;generateRandomString&#8203;(int&nbsp;length)</pre>
<div class="block">Generates a random <code>Base64</code> <code>String</code></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>length</code> - number of <b>bytes</b> generated</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>random <code>String</code></dd>
</dl>
</li>
</ul>
<a id="getSessionAttributeName(de.db.derpate.CSRFForm)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSessionAttributeName</h4>
<pre class="methodSignature">private static&nbsp;java.lang.String&nbsp;getSessionAttributeName&#8203;(@NonNull <a href="../CSRFForm.html" title="enum in de.db.derpate">CSRFForm</a>&nbsp;form)</pre>
<div class="block">Returns the name of the session attribute (prefix
 (<a href="#SESSION_ATTRIBUTE_PREFIX">"csrfTokenList_"</a>) + <a href="../CSRFForm.html#toString()"><code>CSRFForm.toString()</code></a>).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>form</code> - the <a href="../CSRFForm.html" title="enum in de.db.derpate"><code>CSRFForm</code></a></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>name</dd>
</dl>
</li>
</ul>
<a id="getFormTokenFromSession(javax.servlet.http.HttpSession,de.db.derpate.CSRFForm)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFormTokenFromSession</h4>
<pre class="methodSignature">private static&nbsp;@Nullable java.lang.String&nbsp;getFormTokenFromSession&#8203;(@NonNull javax.servlet.http.HttpSession&nbsp;session,
                                                                  @NonNull <a href="../CSRFForm.html" title="enum in de.db.derpate">CSRFForm</a>&nbsp;form)</pre>
<div class="block">Returns the CSRF-Token for a given form and session</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>session</code> - client's <code>HttpSession</code></dd>
<dd><code>form</code> - <a href="../CSRFForm.html" title="enum in de.db.derpate"><code>CSRFForm</code></a></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a Token generated for the given form and user or <code>null</code>,
         if no token was generated yet</dd>
</dl>
</li>
</ul>
<a id="saveToSession(javax.servlet.http.HttpSession,de.db.derpate.CSRFForm,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>saveToSession</h4>
<pre class="methodSignature">private static&nbsp;void&nbsp;saveToSession&#8203;(@NonNull javax.servlet.http.HttpSession&nbsp;session,
                                  @NonNull <a href="../CSRFForm.html" title="enum in de.db.derpate">CSRFForm</a>&nbsp;form,
                                  @NonNull java.lang.String&nbsp;token)</pre>
<div class="block">Sets the session attributes based on the given form</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>session</code> - client's <code>HttpSession</code></dd>
<dd><code>form</code> - <a href="../CSRFForm.html" title="enum in de.db.derpate"><code>CSRFForm</code></a></dd>
<dd><code>list</code> - <code>ArrayList</code> to set</dd>
</dl>
</li>
</ul>
<a id="checkToken(javax.servlet.http.HttpSession,de.db.derpate.CSRFForm,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkToken</h4>
<pre class="methodSignature">public static&nbsp;boolean&nbsp;checkToken&#8203;(@NonNull javax.servlet.http.HttpSession&nbsp;session,
                                 @NonNull <a href="../CSRFForm.html" title="enum in de.db.derpate">CSRFForm</a>&nbsp;form,
                                 @NonNull java.lang.String&nbsp;token)</pre>
<div class="block">This method checks if the given token was registered in the user's
 <code>HttpSession</code></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>session</code> - client's <code>HttpSession</code></dd>
<dd><code>form</code> - <a href="../CSRFForm.html" title="enum in de.db.derpate"><code>CSRFForm</code></a></dd>
<dd><code>token</code> - token given by the user</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code>, if token was registered for the given form
         beforehand; <code>false</code>, if token wasn't registered</dd>
</dl>
</li>
</ul>
<a id="attachNewTokenToHttpResponse(javax.servlet.http.HttpSession,javax.servlet.http.HttpServletResponse,de.db.derpate.CSRFForm)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>attachNewTokenToHttpResponse</h4>
<pre class="methodSignature">public static&nbsp;void&nbsp;attachNewTokenToHttpResponse&#8203;(@NonNull javax.servlet.http.HttpSession&nbsp;session,
                                                @NonNull javax.servlet.http.HttpServletResponse&nbsp;response,
                                                @NonNull <a href="../CSRFForm.html" title="enum in de.db.derpate">CSRFForm</a>&nbsp;form)</pre>
<div class="block">Attaches a http header to the <code>HttpServletResponse</code>, that includes a
 new valid csrf token<br>
 <b>Should be used, when a valid token was sent beforehand!</b></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>session</code> - the <code>HttpSession</code></dd>
<dd><code>response</code> - the <code>HttpServletResponse</code></dd>
<dd><code>form</code> - the <a href="../CSRFForm.html" title="enum in de.db.derpate"><code>CSRFForm</code></a></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CSRFPreventionUtil.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
